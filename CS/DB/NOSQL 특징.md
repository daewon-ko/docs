**NoSQL 특징**





**Nosql이란?**

- Not Only SQL
- 전통적 RDB의 패러다임에서 벗어난 다른 데이터 모델을 사용하는 데이터 베이스 시스템을 지칭
- 분산 시스템을 염두에 두고 설계되었기 때문에 ’대규모 데이터 처리’, ‘높은 확장성’, ‘유연한 데이터 모델링’ 등에 특화



**Nosql의 특징**

- 유연한 데이터 모델링
  - 스키마리스 구조 지원
    - 따라서 Application 레벨에서 스키마를 관리(단점)
  - 데이터 저장하기 전에 스키마를 정의하지 않고 동적으로 데이터 구조를 변경 가능
  - 비정형 데이터를 커버할 수 있다.
- Scale-Out
  - ’샤딩’을 통해 수평적으로 확장가능
  - NoSQL 서버 클러스터를 구성해서 사용을 함
  - RDB는 ACID 트랜잭션을 통한 데이터의 일관성 유지가 최우선적이므로 데이터가 분산된 환경에서 일관성 유지에 제약이 있음
  - 또한 RDB는 일반적으로 스케일 아웃에 특화되어있지 않음
  - RDB의 수직적 확장한계 극복
- 고성능과 높은 가용성
  - high- throughput, Low-Latencey를 충족시킬 수 있음
  - ACID의 일부 원칙을 포기하고 높은 처리량과 낮은 지연성을 채택
    - 따라서 데이터의 일관성이 중요한 도메인에서는 적합하기 어렵다.
    - Ex) 결제, 금융 등
- 데이터의 중복 허용
  - RDB와 달리 join을 회피
    - 중복된 데이터들을 Application 레벨에서 최신 데이터를 유지할 수 있도록 관리





⠀

**RDB와 NoSQL의 용도 비교**

| **특징**        | **RDB**                                  | **NoSQL**                                     |
| --------------- | ---------------------------------------- | --------------------------------------------- |
| **스키마**      | 고정된 스키마, 정형 데이터               | 스키마리스, 비정형 및 반정형 데이터 지원      |
| **확장성**      | 수직적 확장(vertical scaling)            | 수평적 확장(horizontal scaling)               |
| **트랜잭션**    | 완벽한 ACID 트랜잭션 지원                | 제한적 트랜잭션 지원                          |
| **성능**        | 중간에서 높은 성능                       | 높은 읽기/쓰기 성능 (특히 대규모 데이터 처리) |
| **데이터 크기** | 소규모에서 중간 규모 데이터에 적합       | 대규모 데이터 처리에 적합                     |
| **쿼리 언어**   | 표준 SQL 지원                            | 데이터베이스별 독립적 API/언어                |
| **유스케이스**  | 금융, ERP, CRM (복잡한 관계 데이터 처리) | 소셜 미디어, IoT, 빅데이터, 캐싱 시스템       |









**NoSQL에서 말하는 '비정형 데이터(Unstructured Data)'란?**

'비정형 데이터'는 고정된 형식(Schema)이 없는 데이터로, 전통적인 관계형 데이터베이스(RDB)의 **행(Row)**과 **열(Column)** 구조에 맞지 않는 데이터를 의미합니다. 이러한 데이터는 사전 정의된 스키마에 맞춰 저장되지 않으며, 형태나 크기가 다양하고, 저장과 처리가 유연해야 하는 데이터를 포괄합니다.





⠀

**비정형 데이터 vs 반정형 데이터**

| **특징**      | **비정형 데이터**                    | **반정형 데이터(Semi-Structured Data)** |
| ------------- | ------------------------------------ | --------------------------------------- |
| **스키마**    | 없음                                 | 대략적인 구조(키-값 페어 형태)          |
| **예시**      | 이미지, 동영상, 오디오, 텍스트       | JSON, XML, YAML                         |
| **저장 방식** | 파일 스토리지, Blob 스토리지         | 문서형 데이터베이스                     |
| **활용**      | 멀티미디어 콘텐츠, 로그, 소셜 미디어 | API 응답 데이터, 로그 데이터            |



**채팅과 같은 도메인에서 NoSQL을 쓰게되는 이유는 무엇일까?** 



- 유연한 스키마 구조
  - 현재 채팅은 1:1 채팅에서 단순히 텍스트기반으로 메시지를 주고받는 것에 국한되고 있습니다.
  - 그러나, 채팅 메시지에서 파일 업로드를 구현하거나, 읽음여부, 반응 등 여러 가지를 추가하게 되면 스키마가 변경하게 될 수 있는 여지가 많습니다.
  - 이 경우에 NOSQL의 유연한 스키마가 큰 강점을 지닐 수 있음



- 수평적 확장이 용이
  - MongoDB를 예로 들면, MongoDB는 ‘자동 샤딩’을 지원
  - 샤딩 키를 기준으로 분산 저장하여 읽기와 쓰기 작업을 여러 노드에서 병렬 처리 가능
    - RDB는 수평 확장에 제한적임
  - MongoDB는 노드 추가만으로도 성능향상에 강점에 지니며 이에 따라 대규모 트래픽 처리에 용이
- 채팅 도메인 특성
  - 쓰기 작업 속도차이
    - MongoDB는 데이터를 메모리에 먼저 쓰고 이후 디스크에 ‘비동기’로 기록
    - 이에 따라 쓰기 속도가 빠름
  - 읽기 성능 최적화
    - 한 Document에 관련 데이터를 모두 포함하여 단일 조회로 필요한 데이터 가져올 수 있음





**그럼에도 RDB로 채팅을 구현한다면 어떤 특징이 있을까?** 

- RDB로 채팅 구현시 특징
  - 쓰기작업시
    - DB에 쓰기 작업으로 저장
    - 트랜잭션 보장으로 인해, 메시지 저장시 쓰기 성능 저하 가능성 존재
  - 읽기 작업
    - DB에 쿼리



- Nosql로 채팅 구현시 특징
  - 쓰기작업시
    - 비동기 방식으로 빠르게 저장가능
  - 읽기 작업 시
    - 한 번의 쿼리로 전체 대화 조회 가능하긴함
      - MongoDB는 데이터를 메모리로 읽어 처리하므로 단일 Document가 너무 크면 메모리 사용량이 증가하며 네트워크 전송부하가 생길 수 있음 (트레이드 오프)







————————



차라리 RDB로 구현했던걸 NOSQL로 리팩토링하는게 나을ㄷ스







————————







**도메인 특성을 고려한다면 어떨까?**



글 도입부에 언급했듯 해당 토이프로젝트의 목적은 1:1 채팅에 있습니다. 

해당 도메인에 대해서 분석해보자면 다음과 같을 거라고 가정하였습니다. 



**트래픽 특성**

- 쇼핑몰은 일반적인 메신저 앱과 비교하면 **채팅 사용 빈도가 낮음**.
  - 사용자 대부분이 상품 구매나 판매자와의 간단한 질의응답을 위해 채팅을 사용.
  - 실시간 메시지 처리량이 상대적으로 적을 가능성이 큼.
- **읽기보다는 쓰기 작업 비중**이 약간 더 높을 가능성 (메시지를 남겨두고 읽는 경우가 많음).



⠀**데이터 구조**

- 채팅은 단순한 형태의 데이터를 가지며, 복잡한 관계 데이터가 필요하지 않음.
  - 예: sender, receiver, message, timestamp 정도의 간단한 데이터 구조.
- **정규화된 데이터 모델**을 사용해도 데이터 저장과 조회에 큰 부하가 없을 가능성.



⠀**확장성**

- 1:1 채팅이므로 **채팅방의 수와 메시지 수가 제한적**일 가능성이 높음.
  - NoSQL의 샤딩과 수평적 확장이 반드시 필요한 규모는 아닐 수 있음.



⠀**일관성과 안정성**

- 쇼핑몰 도메인에서는 채팅 내용의 **정확성과 일관성**이 중요.
  - 구매자와 판매자 간의 계약 내용이 채팅에 남겨질 수 있음.
  - 데이터 유실, 중복, 비일관성 문제가 발생하면 비즈니스 신뢰도에 악영향.





**이 상황에서도 NoSQL로 DB를 구성하는게 적절할까?** 













- RDB를 이용하되, 중간에 Cache 계층을 둔다면?
- 
- 
- 채팅과 같은 도메인에서 왜 NOSQL을 사용하는 것이 좋을까?
  - 어떠한 도메인이 어떤 DB를 사용하는 것이 좋다는 것은 어떠한 기준에 의해서 정해지는 걸까?
    - 정합성? 실시간성 보장? 처리량, 지연시간?